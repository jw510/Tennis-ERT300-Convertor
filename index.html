<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ERT300 DT/Tension Converter</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { padding: 20px; }
    .tab-content > div { padding-top: 20px; }
    .output { font-size: 1.2em; margin-top: 20px; }
    #converter select, #converter input { margin-bottom: 15px; }
    .history-entry { font-size: 0.95em; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
    .history-entry span { flex-grow: 1; }
    .delete-btn { margin-left: 10px; }
  </style>
</head>
<body>
    <h2 class="text-center mb-4">ERT300 DT/Tension Converter</h2>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="how-tab" data-bs-toggle="tab" data-bs-target="#how" type="button" role="tab">📘 How to Use</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="what-tab" data-bs-toggle="tab" data-bs-target="#what" type="button" role="tab">📏 What is DT</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="convert-tab" data-bs-toggle="tab" data-bs-target="#converter" type="button" role="tab">🧮 Converter</button>
      </li>
    </ul>

    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade show active" id="how" role="tabpanel">
        <p><strong>1.</strong> Clip the ERT300 in the center of the string bed (jump the widest cross string).</p>
        <p><strong>2.</strong> Hold the racket at the throat or grip, and keep it steady during measurement.</p>
        <p><strong>3.</strong> Press the ON button. A simulated ball impact starts (gentle vibrations).</p>
        <p><strong>4.</strong> Read the DT value after 6–8 seconds. The device will shut off automatically.</p>
        <p class="mt-3 text-danger"><strong>Note:</strong> If the ERROR message appears, reposition the device and try again. Hold from the grip instead of throat if needed.</p>
      </div>

      <div class="tab-pane fade" id="what" role="tabpanel">
        <p>DT (Dynamic Tension) is the stiffness of the string bed measured by the ERT300 through an electronic simulation of ball impact.</p>
        <ul>
          <li>Higher DT = More control</li>
          <li>Lower DT = More power</li>
        </ul>
        <p><strong>DT Value Ranges:</strong></p>
        <ul>
          <li>DT 28–34: Defensive Play</li>
          <li>DT 35–41: Dynamic/Offensive Play</li>
          <li>DT 42–46: Fast/Aggressive Play</li>
          <li>DT 47–54: Very Fast/Extremely Aggressive</li>
        </ul>
        <p>DT is measured in kp/cm (or Newton/mm). It represents the force needed to deflect the string bed by 1 cm at the sweet spot.</p>
      </div>

      <div class="tab-pane fade" id="converter" role="tabpanel">
        <label for="headSize">Racket Head Size (sq. in.):</label>
        <select id="headSize" class="form-select">
          <option value="83-94">83-94</option>
          <option value="95-105">95-105</option>
          <option value="106-115">106-115</option>
        </select>
        <label for="dtInput">Enter DT Value:</label>
        <input type="number" id="dtInput" class="form-control" placeholder="Enter DT value (26-53)">
        <label for="racketName">Racket Name:</label>
        <input type="text" id="racketName" class="form-control" placeholder="e.g. Wilson Blade 98">
        <label for="stringType">String Type:</label>
        <input type="text" id="stringType" class="form-control" placeholder="e.g. Luxilon ALU Power">
        <div id="errorMsg" class="text-danger mt-2"></div>
        <div class="output">
          <p><strong>Tension (lbs):</strong> <span id="lbsOutput">-</span></p>
          <p><strong>Tension (kg):</strong> <span id="kgOutput">-</span></p>
        </div>
        <button class="btn btn-primary mt-3" onclick="saveDT()">💾 Save to History</button>
        <div class="mt-4">
          <button class="btn btn-secondary w-100" type="button" data-bs-toggle="collapse" data-bs-target="#historyCollapse">📜 View DT History</button>
          <div class="collapse mt-3" id="historyCollapse">
            <div id="historyContent" class="border rounded p-3"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  const body = document.body;
  const toggleTheme = document.createElement('div');
  toggleTheme.innerHTML = `
    <div class="d-flex justify-content-end mb-2">
  <label for="darkModeToggle" class="form-check-label me-2">🌙 Dark Mode</label>
  <div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" id="darkModeToggle">
  </div>
</div>`;
  document.querySelector('.container').prepend(toggleTheme);

  const toggle = document.getElementById('darkModeToggle');
  const prefersDark = localStorage.getItem('theme') === 'dark';
  if (prefersDark) {
    body.classList.add('bg-dark', 'text-light');
    toggle.checked = true;
  }
  toggle.addEventListener('change', () => {
    if (toggle.checked) {
      body.classList.add('bg-dark', 'text-light');
      localStorage.setItem('theme', 'dark');
    } else {
      body.classList.remove('bg-dark', 'text-light');
      localStorage.setItem('theme', 'light');
    }
  });
</script>

</body>
</html>
